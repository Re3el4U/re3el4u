<!-- Section du bouton TikTok modifiée -->
<div class="cta-section" style="text-align: center; padding: 4rem 0;">
    <h2 style="font-size: 2rem; margin-bottom: 2rem;">Lancer l'Agent IA TikTok</h2>
    <button id="tiktokAgentBtn" class="tiktok-btn">
        <svg viewBox="0 0 24 24" style="width: 24px; height: 24px; margin-right: 10px;">
            <path fill="currentColor" d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/>
        </svg>
        Lancer l'Agent TikTok
    </button>
    <div id="statusMessage" style="margin-top: 1rem; font-size: 1rem; color: #a0a9c0;"></div>
</div>

<style>
.tiktok-btn {
    background: linear-gradient(135deg, #ff0050, #00f2ea);
    color: white;
    border: none;
    padding: 1rem 2.5rem;
    font-size: 1.2rem;
    font-weight: 600;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 10px 30px rgba(255, 0, 80, 0.3);
}

.tiktok-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 15px 40px rgba(255, 0, 80, 0.4);
}

.tiktok-btn:active {
    transform: translateY(-1px);
}

.tiktok-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

#statusMessage.success {
    color: #4caf50;
}

#statusMessage.error {
    color: #ff6b35;
}
</style>

<script>
document.getElementById('tiktokAgentBtn').addEventListener('click', async function() {
    const btn = this;
    const statusMsg = document.getElementById('statusMessage');
    
    // Désactiver le bouton pendant l'exécution
    btn.disabled = true;
    btn.textContent = 'Lancement en cours...';
    statusMsg.textContent = 'Démarrage de l\'agent IA TikTok...';
    statusMsg.className = '';
    
    try {
        // Remplacez cette URL par votre URL webhook Pipedream
        const webhookUrl = 'https://eoeaqtjv9vp8xue.m.pipedream.net';
        
        // Déclencher le workflow Pipedream
        const response = await fetch(webhookUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                source: 're3el4u_website',
                timestamp: new Date().toISOString(),
                action: 'trigger_tiktok_publisher'
            })
        });
        
        if (response.ok) {
            statusMsg.textContent = '✅ Agent IA TikTok lancé avec succès !';
            statusMsg.className = 'success';
        } else {
            throw new Error('Échec du lancement');
        }
    } catch (error) {
        statusMsg.textContent = '❌ Erreur lors du lancement de l\'agent. Veuillez réessayer.';
        statusMsg.className = 'error';
        console.error('Erreur:', error);
    } finally {
        // Réactiver le bouton après 3 secondes
        setTimeout(() => {
            btn.disabled = false;
            btn.innerHTML = '<svg viewBox="0 0 24 24" style="width: 24px; height: 24px; margin-right: 10px;"><path fill="currentColor" d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/></svg>Lancer l\'Agent TikTok';
        }, 3000);
    }
});
</script>
